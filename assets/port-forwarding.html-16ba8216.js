import{_ as s,a as c,b as a,c as m,d as _}from"./5-8aad1104.js";import{_ as p}from"./plugin-vue_export-helper-c27b6911.js";import{r as l,o as h,c as u,a as t,b as e,d as o,w as r,f as d}from"./app-8630854f.js";const g={},f=t("blockquote",null,[t("p",null,[t("em",null,[t("strong",null,"Internal network port forwarding")])])],-1),b=t("h1",{id:"前言",tabindex:"-1"},[t("a",{class:"header-anchor",href:"#前言","aria-hidden":"true"},"#"),e(" 前言")],-1),R=t("em",null,[t("code",null,"ping")],-1),x=t("em",null,[t("code",null,"ping")],-1),T=t("em",null,[t("code",null,"IPv4")],-1),k={href:"https://tool.chinaz.com/port",target:"_blank",rel:"noopener noreferrer"},W=t("em",null,[t("code",null,"ping")],-1),w=t("figure",null,[t("img",{src:s,alt:"1",tabindex:"0",loading:"lazy"}),t("figcaption",null,"😏")],-1),y=d('<li><p><strong>来到主路由上的设置，可以看到这是我对 <em><code>openWRT</code></em> 这个设备进行了端口映射，以及设置为 <em><code>DMZ</code></em> 主机。网上很多人说只要设置了 <em><code>DMZ</code></em> 主机，是可以不用设置端口映射的，经我测试，我这里的设备是行不通的，所以我依然进行了端口映射到 <em><code>openWRT</code></em> 。</strong></p></li><li><p><strong>其实在设置 <em><code>openWRT</code></em> 为端口映射的设备之前，我一直映射的是台式主机的内网地址。我的思路是，既然要在电脑上使用 <em><code>stable-diffusion-webui</code></em> ，那我肯定只需要映射外网端口到电脑主机的内网端口就行了，事实证明，由于我家里网络的复杂程度，这种思路是完全错误的，这也是导致了我频繁映射失败，而无法访问内网的直接原因，因为我跳过了电脑主机网关是 <em><code>openWRT</code></em> 这一情况。所以当我把映射设备改成 <em><code>openWRT</code></em> 后，一下就成功了。（当然， <em><code>openWRT</code></em> 上也必须要对端口进行映射，映射到电脑主机的内网地址）</strong></p></li><li><p><strong>综上，因为我自己大脑宕机，花了超过24个小时的时间来研究内网穿透，实际上就是一个小小的思路上的错误而导致的，这也是为什么我给标题的“复杂”二字加了引号。</strong></p><figure><img src="'+c+'" alt="2" tabindex="0" loading="lazy"><figcaption>😏</figcaption></figure><figure><img src="'+a+'" alt="2" tabindex="0" loading="lazy"><figcaption>😏</figcaption></figure></li>',3),S=d('<h1 id="端口映射" tabindex="-1"><a class="header-anchor" href="#端口映射" aria-hidden="true">#</a> 端口映射</h1><table><thead><tr><th>服务名称</th><th>设备IP</th><th></th><th>外部端口(主机)</th><th>内部端口（主路由）</th><th>外部端口（主路由）</th></tr></thead><tbody><tr><td></td><td></td><td>内部端口(主机)</td><td>内部端口（openWRT）</td><td>外部端口（openWRT）</td><td></td></tr><tr><td>RDP</td><td>192.168.123.110</td><td>3389</td><td>3389</td><td>3389</td><td>3389</td></tr><tr><td>Alist</td><td>192.168.123.110</td><td>5244</td><td>5244</td><td>5244</td><td>5244</td></tr><tr><td>SSH</td><td>192.168.123.110</td><td>22</td><td>2121</td><td>2121</td><td>2121</td></tr><tr><td>openWRT</td><td>192.168.123.3</td><td>80</td><td>22513</td><td>22513</td><td>22513</td></tr></tbody></table><ul><li><strong>可以看到，由于我家里的网络布局，对端口进行了两次映射，先把最外面的主路由端口映射到 <em><code>openWRT</code></em> 上，再把第二层设备 <em><code>openWRT</code></em> 端口映射到主机上，如此就形成了完整的端口映射方案，这下再避开一些电信封禁的端口，是可以完美访问内网设备的。</strong></li></ul><h1 id="域名访问" tabindex="-1"><a class="header-anchor" href="#域名访问" aria-hidden="true">#</a> 域名访问</h1>',4),z=t("em",null,[t("code",null,"ddns-go")],-1),L=t("em",null,[t("code",null,"web")],-1),I=t("em",null,[t("code",null,"web")],-1),v=d('<li><p><strong>来到宝塔面板，添加站点，输入域名+已经映射完成的端口号，访问成功</strong></p><p><img src="'+m+'" alt="4" title=":smirk:" loading="lazy"><br><img src="'+_+'" alt="5" title=":smirk:" loading="lazy"></p></li><li><p><strong>访问网页时，即使加上了 <em><code>SSL</code></em> 也是显示的“不安全”，从研究服务器这么久可以知道，访问内网实际上是一样的，加上 <em><code>SSL</code></em> 是可以成功的。这里一直没有搞懂原因，还是闲下来再测试和折腾吧。。。</strong></p></li>',2);function N(V,B){const n=l("RouterLink"),i=l("ExternalLinkIcon");return h(),u("div",null,[f,b,t("ul",null,[t("li",null,[t("p",null,[t("strong",null,[e("在进行好"),o(n,{to:"/posts/ddns/"},{default:r(()=>[e("上篇")]),_:1}),e("文章的所有操作后，通过远程 "),R,e(" 域名，是可以 "),x,e(" 通家里的 "),T,e(" 地址的，但不知为何，通过域名+端口进行远程访问，是失败的，这说明很有可能是端口没有映射成功，于是我又 "),t("a",k,[W,o(i)]),e(" 了下端口，果然，状态显示是关闭了的。")])]),w]),y]),S,t("ul",null,[t("li",null,[t("p",null,[t("strong",null,[e("按理说，我在"),o(n,{to:"/posts/ddns/"},{default:r(()=>[e("上篇")]),_:1}),e("文章的 "),z,e(" 中添加了域名， "),L,e(" 服务是可以直接通过域名+端口的形式访问的，但是此时会跳转错误。通过分析，其实也不难得出答案，访问 "),I,e(" 服务时，因为域名要占用80端口，但是80端口又是被封禁了，所以是无法用此方法的。")])])]),v])])}const C=p(g,[["render",N],["__file","port-forwarding.html.vue"]]);export{C as default};
